package main.java;

import java.util.Scanner;

public class Purchase {
  private static Purchase p;

  // String customerNum = "";
  int[] lotnum = new int[10];



  /** Set Purchase **/
  public static Purchase getInstance() {
    if (p == null) {
      p = new Purchase();
    }
    return p;
  }



  /** reset Purchase **/
  public static void freeInstance() {
    p = null;
  }



  /** Purchase Lottery **/
  public void purchaseQuestion() {
    Membership m = Membership.getInstance();

    Scanner sc = new Scanner(System.in);

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////// SYSTEM MESAGE///////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    System.out
        .println("\n[INFO]" + m.name + "님, 안녕하세요." + "\n로또를 구매하시겠습니까?" + "\n[1] 예 \t [2] 아니요");

    String answer = "";

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    for (;;) {
      System.out.print("\n입력 : ");
      answer = sc.next();


      // case1: Yes
      if (answer.equals("1") || answer.equals("예")) {
        letsLottery();
        break;
      }
      // case2: No
      else if (answer.equals("2") || answer.equals("아니요")) {
        System.out.println("\\n[ERROR] 로또 구매가 종료되었습니다.");
        System.exit(0);
      }
      // case3: ERROR
      else {
        System.out.println("\n[ERROR] 잘못된 입력입니다. 다시 입력해주세요.");
      }
    }
  }



  /** Set Lottery 6 Num **/
  public void letsLottery() {

    // String[] num = new String[6];\
    int num = 0;
    int buffnum = 0b00_0000_0000; // 00 0000 0000
    int overnum = 0b00_0000_0000; // 00 0000 0000

    Scanner sc = new Scanner(System.in);

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////// SYSTEM MESAGE///////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    System.out.println("\n[INFO] 1의 자리 숫자로 총 6개의 로또 번호를 입력해주세요.");

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////



    ////////////////////////////// num 0~5 set //////////////////////////////
    for (int i = 0; i < 6; i++) {
      ////////////////////////////// num i //////////////////////////////
      for (;;) {
        // System.out.print("\n입력 번호 : " + printNum() + "\n");
        System.out.print((i + 1) + "번째 번호 입력 : ");
        num = sc.nextInt();

        // case1: ERROR(over num)
        if (num > 10 || num < 0) {
          System.out.println("1의 자리 숫자만 입력해주세요. ( 0 ~ 9 )");
        }
        // case2:set customerNum
        else {
          buffnum = 0b00_0000_0001 << num;
          if ((overnum & buffnum) == 0) {
            overnum |= buffnum;
          } else {
            System.out.println("중복된 숫자입니다.");
          }
          // this.customerNum += num[i];
          break;
        }


      }
      //////////////////////////////////////////////////////////////////
    }
    /////////////////////////////////////////////////////////////////////////



    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////// SYSTEM MESAGE///////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    inputNum(overnum);
    System.out.print("\n[INFO] 입력하신 번호는");
    System.out.print(printNum());
    System.out.print("입니다.");
    System.out.println("\n입력하신 번호로 로또 구매 진행하시겠습니까?" + "\n[1] 예 \t [2] 아니요");

    String answer = "";

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////


    for (;;) {
      System.out.print("\n입력 : ");
      answer = sc.next();

      // case1: YES
      if (answer.equals("1") || answer.equals("예")) {
        order();
        break;
      }
      // case2: NO
      else if (answer.equals("2") || answer.equals("아니요")) {
        System.out.println("\n[ERROR] 로또 구매가 종료되었습니다.");
        System.exit(0);
      }
      // case3: ERROR
      else {
        System.out.println("\n[ERROR] 잘못된 입력입니다. 다시 입력해주세요.");
      }

    }

  }

  /** enter pw **/
  public void order() {
    Membership m = Membership.getInstance();
    Scanner sc = new Scanner(System.in);

    String pw = "";

    for (;;) {
      /////////////////////////////////////////////////////////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////
      ///////////////////////////////////// SYSTEM MESAGE//////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////

      System.out.println("\n[INFO] 결제 비밀번호를 입력해주세요.");
      System.out.print("입력 : ");
      pw = sc.next();

      /////////////////////////////////////////////////////////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////
      /////////////////////////////////////////////////////////////////////////////////////////////

      // case1: PASS
      if (pw.equals(m.pw)) {
        System.out.println("\n[INFO] 결제가 완료되었습니다.");
        System.out.println("\n[INFO] 3초 후에 로또 추첨이 진행됩니다.");
        break;
      }
      // case2: ERROR
      else {
        System.out.println("\n[ERROR] 결제 비밀번호가 일치하지 않습니다. 다시 입력해주세요.");
      }
    }
  }



  /** Input Num data->lotnum **/
  public void inputNum(int num) {
    int position = 0;

    while (position < this.lotnum.length) {
      if ((num & 1) == 1) {
        this.lotnum[position] = 1;
      }
      num >>= 1;
      position++;
    }

  }


  /** Print Num data **/
  public String printNum() {
    String print = "";
    for (int i = 0; i < this.lotnum.length; i++) {
      if (this.lotnum[i] == 1) {
        print += i;
      }
    }
    return print;
  }
}
